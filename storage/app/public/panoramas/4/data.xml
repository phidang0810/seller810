<krpano>
    <include url="https://s3.amazonaws.com/dhd-films-live/krpano/plugins/showtext.xml"/>
    <plugin name="soundinterface"
            url.flash="https://s3.amazonaws.com/dhd-films-live/krpano/plugins/soundinterface.swf"
            url.html5="https://s3.amazonaws.com/dhd-films-live/krpano/plugins/soundinterface.js"
            preload="true"
            rootpath=""
            volume="1.0"
            mute="false"
    />
    <!--<events name="hotspots_visibility" keep="true" onviewchanged="adapt_hortspots_visiblity();"/>-->
    <plugin name="gyro" devices="html5"
            xurl="%SWFPATH%/plugins/gyro2.js"
            enabled="false"
            onavailable="gyro_available_info();"
            onunavailable="gyro_not_available_info();"
            softstart="1"
    />
    <events name="viewtoonstart" keep="true" onloadcomplete="loadComplete()" />
    <style name="roomspot" alpha="0.0" capture="false" />
    <style name="skin_tooltips"
           onover.mouse="copy(layer[skin_tooltip].html, tooltip);
	                     set(layer[skin_tooltip].visible, calc(webvr.isenabled ? false : true));
	                     tween(layer[skin_tooltip].alpha, 1.0, 0.1);
	                     asyncloop(hovering, copy(layer[skin_tooltip].x,mouse.stagex); copy(layer[skin_tooltip].y,mouse.stagey); );"
           onout.mouse="tween(layer[skin_tooltip].alpha, 0.0, 0.1, default, set(layer[skin_tooltip].visible,false), copy(layer[skin_tooltip].x,mouse.stagex); copy(layer[skin_tooltip].y,mouse.stagey); );"
    />
    <style name="newpoly" fillcolor="0xff0000" fillalpha="0.2" borderwidth="3.0" bordercolor="0xaaaaaa" borderalpha="1.0" onover="tween(fillalpha,0.5);" onout="tween(fillalpha,0.2);" onclick="showlog();" ondown.touch="onover(); asyncloop(pressed, onhover(); );" onup.touch="onout();" onover.mouse="copy(layer[skin_tooltip].html, tooltip);
    	                     set(layer[skin_tooltip].visible, calc(webvr.isenabled ? false : true));
    	                     tween(layer[skin_tooltip].alpha, 1.0, 0.1);
    	                     asyncloop(hovering, copy(layer[skin_tooltip].x,mouse.stagex); copy(layer[skin_tooltip].y,mouse.stagey); );"
           onout.mouse="tween(layer[skin_tooltip].alpha, 0.0, 0.1, default, set(layer[skin_tooltip].visible,false), copy(layer[skin_tooltip].x,mouse.stagex); copy(layer[skin_tooltip].y,mouse.stagey); );"/>
    <style name="dragableHotspot" />
    <style name="dragableVideo" />
    <action name="draghotspot" />
    <action name="dragging" />
    <action name="focusVideoHS">
        togglepause();
    </action>
    <action name="focusHS">
        lookto(get(ath),get(atv),90)
    </action>
    <action name="adapt_hortspots_visiblity">
        for(set(i,0), i LT hotspot.count, inc(i),getlooktodistance(d, hotspot[get(i)].ath, hotspot[get(i)].atv); if(d LT 30,showhotspot(get(i) );,fadehotspot(get(i), 0.5, 0.5);); );
    </action>
    <action name="showhotspot">
        if(hotspot[%1].ishighlighted != true,set(hotspot[%1].isvisible, true);tween(hotspot[%1].alpha, 1, 1););
    </action>
    <action name="fadehotspot">
        set(hotspot[%1].isvisible, false);tween(hotspot[%1].alpha, 0.1, 0.5);
    </action>

    <action name="overChildTag">
        if(layer[infoImage].url,
        set(tagChild, 1);
        set(layer[HSInfo].visible,true);
        set(calc(layer[HSInfo].parent + '.zorder'), 999);
        );
    </action>
    <action name="outChildTag">
        set(tagChild, 0);
        delayedcall(0.1, hideTag(); );
    </action>
    <action name="hideTag">
        if (tagChild != 1 AND tagParent != 1, set(layer[HSInfo].visible,false););
    </action>
    <action name="overParentTag">
        if (tagChild != 1 AND tagParent != 1 AND hotspot[get(name)].dataName,
        set(calc(layer[HSInfo].parent + '.zorder'), 1);
        set(layer[HSInfo].parent, calc:'hotspot[' + name + ']');
        set(%1.zorder, 999);
        set(layer[infoImage].url,calc:hotspot[get(name)].dataAvatar);
        set(layer[infoName].html, calc:'[div class="hsName"]' + hotspot[get(name)].dataName + '[div]');
        set(layer[infoAdd].html, calc:'[div class="hsLink"][a href="'+hotspot[get(name)].dataUrl+'" target="_blank"]Connect with me ' + hotspot[get(name)].dataIcon+ '[/a][/div]');
        set(layer[HSInfo].visible,true);
        set(tagParent, 1);
        )
    </action>
    <action name="outParentTag">
        set(tagParent, 0);
        delayedcall(0.1, hideTag(); );
    </action>

    <action name="toggleHotspotVisibility">
        for(set(i,0), i LT hotspot.count, inc(i),
        if ( hotspot[get(i)].mtype == 'icon', set(hotspot[get(i)].visible, %1); );
        );

    </action>
    <action name="goto">
        loadscene(%1, null, MERGE, OPENBLEND(0.8, 0.0, 0.6, 0.3, easeOutQuad));
        js(generalNewHotSpot(%1));
    </action>

    <action name="onstart">
        if(scene[get(xml.scene)].main,
            js(hide('#exit-bt'));
        );

        js(generalNewHotSpot());
    </action>

    <action name="loadComplete">
        set(enable, get(scene[get(xml.scene)].zoom));
        js(toggleZoom(get(enable)));
        js(hide('#loading'));
        delayedcall(5,
            js(hide('#tutorial-box'));
        );
        ifnot(vlookat === null AND hlookat === null AND fov === null, lookto(get(hlookat),get(vlookat), get(fov), smooth(250,250,220)); );
    </action>
    <!-- startup action - load the first scene -->
    <action name="startup" autorun="onstart">
        set(mainScene, 0);
        for(set(i,0), i LT scene.count, inc(i),
        if (scene[get(i)].main AND scene[get(i)].main == 1,set(mainScene, calc(i));)
        );

        if(startscene === null OR !scene[get(startscene)], copy(startscene,scene[get(mainScene)].name); );

        loadscene(get(startscene), null, MERGE);

        if(startactions !== null, startactions() );
    </action>


    <action name="hotspot_topdown">
        if(hotspot[%1].loaded,
        tween(hotspot[%1].atv, %2, 0.5, easeInOutQuad, tween(hotspot[%1].atv, %3, 0.5, default, hotspot_topdown(%1, %2, %3) ) );
        );
    </action>

    <style name="button" type="text"
           css="text-align:center;"
           padding="4 8"
           mergedalpha="false"
           bgborder="4 0xFFFFFF 1"
           bgroundedge="1"
           bgshadow="0 1 4 0x000000 1.0"
           onover="set(bgcolor, 0xC7E4FC);"
           onout="calc(bgcolor, pressed ? 0x90CAF9 : 0xFFFFFF);"
           ondown="set(bgcolor, 0x90CAF9);"
           onup="calc(bgcolor, hovering ? 0xC7E4FC : 0xFFFFFF);"
    />

    <action name="makescreenshot_init" type="Javascript" autorun="onstart"><![CDATA[
		krpano.makescreenshot = function()
		{
			// create an empty Object as makeScreenshot cache
			krpano.makeScreenshotCache = {};

			var zoom = 3;
			var crop = {
			    x: zoom*krpano.get('layer[viewfinder].pixelx'),
			    y: zoom*krpano.get('layer[viewfinder].pixely'),
			    w: zoom*krpano.get('layer[viewfinder].pixelwidth'),
			    h: zoom*krpano.get('layer[viewfinder].pixelheight')
			};
			var width = zoom*krpano.get('area.pixelwidth');
			var height = zoom*krpano.get('area.pixelheight');
			var screenshotcanvas = krpano.webGL.makeScreenshot(width, height, false, "jpeg", 1.0, crop);
			krpano.set('screenshot',screenshotcanvas);

			krpano.set('layer[btShot].visible', false);
			krpano.set('layer[loading].visible', true);
			krpano.set('layer[viewfinder].bgalpha', '0.7');
			krpano.call('js(snapshotCallback(get(screenshot)))');
		}

]]></action>
    <skin_settings maps="false"
                   maps_type="google"
                   maps_bing_api_key=""
                   maps_google_api_key=""
                   maps_zoombuttons="false"
                   webvr="true"
                   webvr_gyro_keeplookingdirection="false"
                   webvr_prev_next_hotspots="true"
                   littleplanetintro="false"
                   title="true"
                   thumbs="true"
                   thumbs_width="120" thumbs_height="80" thumbs_padding="10" thumbs_crop="0|40|240|160"
                   thumbs_opened="false"
                   thumbs_text="true"
                   thumbs_dragging="true"
                   thumbs_onhoverscrolling="false"
                   thumbs_scrollbuttons="false"
                   thumbs_scrollindicator="false"
                   thumbs_loop="false"
                   tooltips_buttons="true"
                   tooltips_thumbs="true"
                   tooltips_hotspots="true"
                   tooltips_mapspots="true"
                   deeplinking="false"
                   loadscene_flags="KEEPVIEW"
                   loadscene_blend="OPENBLEND(0.5, 0.0, 0.75, 0.05, linear)"
                   loadscene_blend_prev="SLIDEBLEND(0.5, 180, 0.75, linear)"
                   loadscene_blend_next="SLIDEBLEND(0.5,   0, 0.75, linear)"
                   loadingtext=""
                   layout_width="100%"
                   layout_maxwidth="860"
                   controlbar_width="-24"
                   controlbar_height="70"
                   controlbar_offset="0"
                   controlbar_offset_closed="-40"
                   controlbar_overlap.no-fractionalscaling="10"
                   controlbar_overlap.fractionalscaling="0"
                   design_skin_images="vtourskin.png"
                   design_bgcolor="1d1c1ccc"
                   design_bgalpha="0.8"
                   design_bgborder="0"
                   design_bgroundedge="1"
                   design_bgshadow="0 4 10 0x000000 0.3"
                   design_thumbborder_bgborder="3 0xFFFFFF 1.0"
                   design_thumbborder_padding="2"
                   design_thumbborder_bgroundedge="0"
                   design_text_css="color:#FFFFFF; font-family:Arial;"
                   xdesign_text_css="color:#FFFFFF; font-family:Arial;font-size:96px;"
                   design_text_shadow="1"

    />

    <layer name="viewfinder" type="container" height="400" width="600" align="center" bgcolor="0x000000" bgalpha="0" bgborder="3 0xffffff 1.0" keep="true" visible="false" alpha="1">
        <layer url="https://s3.amazonaws.com/dhd-films-live/krpano/skin/viewfinder.png" width="90%" height="90%" parent="layer[viewfinder]" align="center" alpha="1.0" capture="false" />
        <layer name="btShot" url="https://s3.amazonaws.com/dhd-films-live/krpano/skin/camera.png" parent="layer[viewfinder]" align="bottom" alpha="1.0" capture="true" scale="0.8" onclick="playsound(click,https://s3.amazonaws.com/dhd-films-live/krpano/shutter.mp3);makescreenshot()" onover="tween(scale,0.9);" onout="tween(scale,0.8);" />
        <layer name="shadowTop" parent="layer[viewfinder]" bgcapture="true" type="container" width="4000" height="400" bgcolor="0x000000" bgalpha="0.7" visible="true" align="bottom" y="-397" />
        <layer name="shadowBottom" parent="layer[viewfinder]" bgcapture="true" type="container" width="4000" height="400" bgcolor="0x000000" bgalpha="0.7" visible="true" align="top" y="-403" />
        <layer name="shadowLeft" parent="layer[viewfinder]" bgcapture="true" type="container" width="1000" height="400" bgcolor="0x000000" bgalpha="0.7" visible="true" align="left" x="-1003" y="-3" />
        <layer name="shadowRight" bgcapture="true" type="container" width="1000" height="400" bgcolor="0x000000" bgalpha="0.7" visible="true" align="right" x="-996" y="-3" />
        <layer name="closeBt" width="30" height="30" x="0" y="-40" url="https://s3.amazonaws.com/dhd-films-live/krpano/skin/closevf.png" parent="layer[viewfinder]" align="righttop" alpha="1.0" capture="true"  onclick="set(layer[viewfinder].visible,false);" />
        <layer name="loading" parent="layer[viewfinder]" type="text" html="[h3]Loading...[/h3]" bgalpha="0" css="color:#ffffff" align="center" visible="false"/>
    </layer>

    <layer name="HSInfo" keep="true" type="container" width="220" height="60" alpha="1.0" visible="false" borderalpha="0.7" parent="" bgcolor="0xeaeff1" bgalpha="1.0" bgborder="1 0xeaeff1 1.0" bgroundedge="0" bgshadow="0 4 10 0x000000 0.5" onover="overChildTag()" onout="outChildTag()" x="55" y="-15">
        <layer name="infoImage" type="image" url="" bgborder="1 000000 1.0" width="60" height="60" x="0" y="0"/>
        <layer name="infoArrow" type="text" bgalpha="0" bgborder="0 000000 0" html="[div class='hsArrow'][/div]" width="20" height="30" x="-17" y="15"/>
        <layer name="infoName" type="text" html="" width="160" height="30" x="60" y="0"/>
        <layer name="infoAdd" type="text" html="" width="160" height="30" x="60" y="30"/>
    </layer>
    <action name="heartBeat">
        tween(scale, 0.4, 0.2, default, tween(scale, 0.3, 0.8, default, heartBeat() ) );
    </action>
    <include scene="1" url="https://dhd-films-live.s3.amazonaws.com/videos/40/data.xml"/>
    <include scene="1" url="https://dhd-films-live.s3.amazonaws.com/videos/41/data.xml"/>
    <include scene="1" url="https://dhd-films-live.s3.amazonaws.com/videos/42/data.xml"/>
    <include scene="1" url="https://dhd-films-live.s3.amazonaws.com/videos/45/data.xml"/>
    <include scene="1" url="https://dhd-films-live.s3.amazonaws.com/scenes/125/pano.xml?nocache=1530593507"/>
    <include scene="1" url="https://dhd-films-live.s3.amazonaws.com/scenes/126/pano.xml?nocache=1530593507"/>
    <include scene="1" url="https://dhd-films-live.s3.amazonaws.com/scenes/127/pano.xml?nocache=1530593534"/>
    <include scene="1" url="https://dhd-films-live.s3.amazonaws.com/scenes/128/pano.xml?nocache=1530593561"/>
    <include scene="1" url="https://dhd-films-live.s3.amazonaws.com/scenes/129/pano.xml?nocache=1530593588"/>
    <include scene="1" url="https://dhd-films-live.s3.amazonaws.com/scenes/130/pano.xml?nocache=1530593614"/>
</krpano>